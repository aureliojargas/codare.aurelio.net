<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<title>Ruby: Obter o nome do método atual | CODARE</title>
<link rel="stylesheet" type="text/css" media="all" href="http://codare.aurelio.net/wp-content/themes/twentyten/style.css" />
<link rel='prev' title='Python: Evitando o excesso de &quot;or&quot; em condicionais' href='http://codare.aurelio.net/2007/03/09/python-evitando-o-excesso-de-or-em-condicionais/' />
<link rel='next' title='PHP: Descobrir métodos e atributos de uma classe (Reflection)' href='http://codare.aurelio.net/2007/03/13/php-descobrir-metodos-e-atributos-de-uma-classe-reflection/' />
<link rel="icon" href="http://codare.aurelio.net/wp-content/uploads/2010/12/favicon.png" type="image/png" />
</head>

<body class="post-template-default single single-post postid-135 single-format-standard custom-background">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="http://codare.aurelio.net/" title="CODARE" rel="home">CODARE</a>
					</span>
				</div>
				<div id="site-description">Programadores, uni-vos!</div>

										<img src="http://codare.aurelio.net/wp-content/uploads/2010/12/cropped-codare-oficial-22.jpg" width="940" height="198" alt="" />
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu-header"><ul id="menu-categorias" class="menu"><li id="menu-item-545" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-545"><a href="http://codare.aurelio.net/category/applescript/">AppleScript</a></li>
<li id="menu-item-547" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-547"><a href="http://codare.aurelio.net/category/c/">C</a></li>
<li id="menu-item-548" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-548"><a href="http://codare.aurelio.net/category/cpp/">CPP</a></li>
<li id="menu-item-549" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-549"><a href="http://codare.aurelio.net/category/csharp/">CSharp</a></li>
<li id="menu-item-550" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-550"><a href="http://codare.aurelio.net/category/java/">Java</a></li>
<li id="menu-item-551" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-551"><a href="http://codare.aurelio.net/category/javascript/">JavaScript</a></li>
<li id="menu-item-552" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-552"><a href="http://codare.aurelio.net/category/latex/">LaTeX</a></li>
<li id="menu-item-557" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-557"><a href="http://codare.aurelio.net/category/mysql/">MySQL</a></li>
<li id="menu-item-560" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-560"><a href="http://codare.aurelio.net/category/php/">PHP</a></li>
<li id="menu-item-561" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-561"><a href="http://codare.aurelio.net/category/python/">Python</a></li>
<li id="menu-item-562" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-562"><a href="http://codare.aurelio.net/category/ruby/">Ruby</a></li>
<li id="menu-item-563" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-563"><a href="http://codare.aurelio.net/category/shell/">Shell</a></li>
<li id="menu-item-565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-565"><a href="http://codare.aurelio.net/category/tcl-tk/">Tcl-Tk</a></li>
<li id="menu-item-556" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-556"><a href="http://codare.aurelio.net/category/misc/">Misc</a></li>
<li id="menu-item-555" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-555"><a href="http://codare.aurelio.net/category/mac/">Mac</a></li>
<li id="menu-item-553" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-553"><a href="http://codare.aurelio.net/category/linux/">Linux</a></li>
<li id="menu-item-567" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-567"><a href="http://codare.aurelio.net/category/windows/">Windows</a></li>
<li id="menu-item-568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-568"><a href="http://codare.aurelio.net/category/__codare/">__codare</a></li>
<li id="menu-item-543" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-543"><a href="http://codare.aurelio.net/sobre/">Sobre</a></li>
<li id="menu-item-544" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-544"><a href="http://codare.aurelio.net/equipe/">Equipe</a></li>
</ul></div>			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://codare.aurelio.net/2007/03/09/python-evitando-o-excesso-de-or-em-condicionais/" rel="prev"><span class="meta-nav">&larr;</span> Python: Evitando o excesso de &quot;or&quot; em condicionais</a></div>
					<div class="nav-next"><a href="http://codare.aurelio.net/2007/03/13/php-descobrir-metodos-e-atributos-de-uma-classe-reflection/" rel="next">PHP: Descobrir métodos e atributos de uma classe (Reflection) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-135" class="post-135 post type-post status-publish format-standard hentry category-ruby">
					<h1 class="entry-title">Ruby: Obter o nome do método atual</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="http://codare.aurelio.net/2007/03/12/ruby-obter-o-nome-do-metodo-atual/" title="09:00" rel="bookmark"><span class="entry-date">12/03/2007</span></a> <span class="meta-sep">by</span> <span class="author vcard"><a class="url fn n" href="http://codare.aurelio.net/author/taq/" title="View all posts by Eustáquio Rangel (TaQ)">Eustáquio Rangel (TaQ)</a></span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>Palavras-chave: Ruby, método, nome, corrente, method, current</p>
<p>Se você quiser saber o nome do método onde se encontra, terá que criar um outro método que quando chamado descubra o nome do método que o chamou. Assim:</p>
<pre>
class MinhaClasse
	def self.nome_do_metodo
		caller.first
	end
	def self.meu_metodo
		puts "Estou no método '#{nome_do_metodo}'"
	end
end
MinhaClasse.meu_metodo =&gt;
    Estou no método 'method_name.rb:6:in `meu_metodo''
</pre>
<p>No retorno acima, veio o nome do arquivo &#8220;method_name.rb&#8221; e logo após, o nome do método de onde imprimi a mensagem: &#8220;meu_metodo&#8221;.</p>
<p>Usando expressões regulares é possível filtrar essa mensagem, para torná-la mais amigável. Como Ruby permite que alteremos até as classes básicas da linguagem (dê um tiro no pé apenas se você quiser!), vamos gerar um método do Kernel para que possamos usá-lo globalmente:</p>
<pre>
module Kernel
	def nome_do_metodo
		caller.first =~ /`([^']*)'/ and $1
	end
end

class MinhaClasse
	def self.meu_metodo
		puts "Estou no método '#{nome_do_metodo}'"
	end
end

class OutraClasse
	def self.meu_outro_metodo
		puts "Estou no método '#{nome_do_metodo}'"
	end
end
MinhaClasse.meu_metodo =&gt; Estou no método 'meu_metodo'
OutraClasse.meu_outro_metodo =&gt; Estou no método 'meu_outro_metodo'
</pre>
<p>Explicando:</p>
<p>A chamada em <tt>caller.first</tt> retorna de onde o método foi chamado (justamente o método que queremos saber o nome), e compara com a expressão regular para ver se achou algum nome de método no final.</p>
<p>Ali é feito um &#8220;curto-circuito&#8221; onde é testado se a expressão regular &#8220;casou&#8221;, fazendo um <tt>and</tt> lógico com a última condição avaliada, que no caso, é <tt>$1</tt>.</p>
<p>Esse $1 é a primeira variável de Ruby que traz o conteúdo que &#8220;casou&#8221; da expressão regular. Se não casou, a segunda parte do <tt>and</tt> nem é avaliada e é retornado <tt>nil</tt>. Se casou, é retornada a parte que casou, que nesse caso, é o nome do método que queremos.</p>
											</div><!-- .entry-content -->


					<div class="entry-utility">
						This entry was posted in <a href="http://codare.aurelio.net/category/ruby/" rel="category tag">Ruby</a>. Bookmark the <a href="http://codare.aurelio.net/2007/03/12/ruby-obter-o-nome-do-metodo-atual/" title="Permalink to Ruby: Obter o nome do método atual" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://codare.aurelio.net/2007/03/09/python-evitando-o-excesso-de-or-em-condicionais/" rel="prev"><span class="meta-nav">&larr;</span> Python: Evitando o excesso de &quot;or&quot; em condicionais</a></div>
					<div class="nav-next"><a href="http://codare.aurelio.net/2007/03/13/php-descobrir-metodos-e-atributos-de-uma-classe-reflection/" rel="next">PHP: Descobrir métodos e atributos de uma classe (Reflection) <span class="meta-nav">&rarr;</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">




</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
			<ul class="xoxo">

<li id="text-4" class="widget-container widget_text">			<div class="textwidget"><div style="
    background: yellow;
    color: black;
    border: 1px solid black;
    padding: 10px;
    font-size: 125%;
    line-height: 150%;
"><b>ATENÇÃO: Este site está aposentado.</b><br>
Não receberá posts nem comentários novos. Para ler dicas mais recentes, vá no <a href="https://pt.stackoverflow.com/">Stack Overflow</a>.</div></div>
		</li><li id="text-3" class="widget-container widget_text"><h3 class="widget-title">Livros da equipe do CODARE</h3>			<div class="textwidget"><p>
	<a href="http://piazinho.com.br"><img src='http://codare.aurelio.net/wp-content/uploads/2010/12/livro-regex3.jpg' alt='Livro Regex' /></a>
	<br>
	<a href="http://piazinho.com.br">Expressões Regulares<br>
	Uma Abordagem Divertida</a><br>
	de Aurelio Marinho Jargas
</p>
<p>
	<a href="http://shellscript.com.br"><img src='http://codare.aurelio.net/wp-content/uploads/2008/06/livro-shell.jpg' alt='Livro Shell' /></a>
	<br>
	<a href="http://shellscript.com.br">Shell Script Profissional</a><br>
	de Aurelio Marinho Jargas
</p>
<p>
	<a href="http://www.submarino.com.br/produto/111677292/php-gtk-criando-aplicacoes-graficas-com-php?franq=AFL-03-43980"><img src='http://codare.aurelio.net/wp-content/uploads/2007/05/livro-phpgtk.jpg' alt='Livro PHP GTK' /></a>
	<br>
	<a href="http://www.submarino.com.br/produto/111677292/php-gtk-criando-aplicacoes-graficas-com-php?franq=AFL-03-43980">PHP-GTK</a><br>
	de Pablo Dall'Oglio
</p>
<p>
	<a href="http://www.submarino.com.br/produto/6871690/livro-php-programando-com-orientacao-a-objetos?franq=AFL-03-43980"><img src='http://codare.aurelio.net/wp-content/uploads/2008/06/livro-phpoo.jpg' alt='Livro PHP POO' /></a>
	<br>
	<a href="http://www.submarino.com.br/produto/6871690/livro-php-programando-com-orientacao-a-objetos?franq=AFL-03-43980">PHP Programando com Orientação a Objetos</a><br>
de Pablo Dall'Oglio
</p>
<p>
	<a href="http://busca.submarino.com.br/busca.php?q=ruby+brasport&amp;franq=AFL-03-43980"><img src='http://codare.aurelio.net/wp-content/uploads/2007/04/livro-ruby.jpg' alt='Livro Ruby' /></a>
	<br>
	<a href="http://busca.submarino.com.br/busca.php?q=ruby+brasport&amp;franq=AFL-03-43980">Ruby: Conhecendo a Linguagem</a><br>
de Eustáquio Rangel (TaQ)
</p>
</div>
		</li>			</ul>
		</div><!-- #primary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="http://codare.aurelio.net/" title="CODARE" rel="home">
					CODARE				</a>
			</div><!-- #site-info -->

			<div id="site-generator">
				<a href="https://github.com/aureliojargas/codare.aurelio.net">Fontes do site no GitHub</a>
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->

</body>
</html>
